name: Explorar e Baixar Vídeo Google Drive

on:
  workflow_dispatch:
    inputs:
      drive_url:
        description: 'URL do Google Drive (com id=...)'
        required: true
        type: string

jobs:
  baixar-video:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Instalar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: Instalar dependências
        run: npm install puppeteer axios fs-extra

      - name: Criar script baixar.js
        run: |
          echo "${{ secrets.SCRIPT_CONTENT }}" > baixar.js

      - name: Executar Puppeteer para baixar vídeo
        env:
          DRIVE_URL: ${{ github.event.inputs.drive_url }}
        run: node baixar.js

      - name: Upload do vídeo como artefato
        uses: actions/upload-artifact@v4
        with:
          name: video-google-drive
          path: video.mp4
